<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Real Estate Listings</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/css/style.css" />
</head>

<body>
  <header class="nav-shell">
    <div class="nav-top">
      <button id="menuToggle" class="menu-btn" aria-expanded="false" aria-controls="navLinks">
        <span class="menu-icon"></span>
        <span class="menu-text">Menu</span>
      </button>

      <a href="index.html" class="brand">
        <img src="/Assets/Logo.png" alt="logo" style="height: 40px" />
      </a>

      <div class="navbar-buttons" id="navbarUser">
        <a class="button-primary" href="signUp.html" style="text-decoration: none; color: #fff">Sign Up</a>
        <a class="button-primary" href="login.html" style="text-decoration: none; color: #fff">Login</a>
      </div>
    </div>

    <div id="navLinks" class="nav-links">
      <nav id="navbar" class="navbar-selector">
        <a href="buy.html">Buy</a>
        <a href="rent.html">Rent</a>
        <a href="sold.html">Sold</a>
        <a href="findAgent.html">Find Agent</a>
        <a href="news.html">News</a>
      </nav>
    </div>
  </header>

  <div id="hero-section">
    <div class="hero-section-center">
      <div class="hero-text">
        <p class="h1">The Breakthrough Platform for Smarter Home Finding</p>
        <p class="sub-header">
          Streamline planning management, enhance collaboration, and deliver
          results with MyHome
        </p>
      </div>

      <div class="search-section">
        <div class="search-navbar">
          <div class="search-navbar-texts">
            <p class="search-tab active" data-type="rent">Rent</p>
            <p class="search-tab" data-type="sold">Sold</p>
            <p class="search-tab" data-type="address">Address</p>
            <p class="search-tab" data-type="agent">Agent</p>
            <p class="search-tab comingsoon">Coming Soon</p>
          </div>

          <div class="line"></div>
        </div>

        <div class="search-box">
          <div class="search-placeholder">
            <img src="../Assets/search.png" alt="searchicon" />
            <input type="text" id="searchInput" placeholder="Search suburb, postcode or state" style="
                  border: none;
                  outline: none;
                  width: 250px;
                  font-size: 16px;
                " />
          </div>
          <div style="border-radius: 40px" class="button-secondary-round">
            <img src="../Assets/filter.png" alt="filtericon" /> Filters
          </div>
          <div style="border-radius: 40px" class="button-primary-round" id="searchBtn">
            Search
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="optimization">
    <div class="optimization-text">
      <p class="optimization-h1">
        Best optimization based on your credentials
      </p>
      <p class="optimization-subheader">
        Streamline planning management, enhance collaboration, and deliver
        results with Central Quita
      </p>
    </div>

    <div class="container-layout" id="listingContainer">
      <!--
        <div class="container">
          <div class="property-image">
            <div class="property-pill">
              <p>New</p>
            </div>
            <div class="property-details">
              <p>Green Square, NSW</p>
              <div class="property-details-icons">
                <div class="icon-text">
                  <p>2</p>
                  <img src="../Assets/bed.png" alt="bed" />
                </div>
                <div class="icon-text">
                  <p>2</p>
                  <img src="../Assets/shower.png" alt="toilet" />
                </div>
                <div class="icon-text">
                  <p>1</p>
                  <img src="../Assets/car.png" alt="car" />
                </div>
              </div>
            </div>
            <img src="../Assets/cream/cream1.png" alt="" />
          </div>

          <div class="love">
            <div class="text-love">
              <p>312 Zetland, NSW</p>
              <div class="unit-tag">
                <img src="../Assets/dot-grey.png" alt="dot" />
                <p>Apartment</p>
              </div>
            </div>
            <img
              class="love-icon"
              src="../Assets/love-icon.png"
              alt="Love-icon"
            />
          </div>
        </div>

        <div class="container">
          <div class="property-image">
            <div class="property-pill">
              <p>New</p>
            </div>
            <div class="property-details">
              <p>Green Square, NSW</p>
              <div class="property-details-icons">
                <div class="icon-text">
                  <p>2</p>
                  <img src="../Assets/bed.png" alt="bed" />
                </div>
                <div class="icon-text">
                  <p>2</p>
                  <img src="../Assets/shower.png" alt="toilet" />
                </div>
                <div class="icon-text">
                  <p>1</p>
                  <img src="../Assets/car.png" alt="car" />
                </div>
              </div>
            </div>
            <img src="../Assets/cream/cream3.png" alt="" />
          </div>

          <div class="love">
            <div class="text-love">
              <p>312 Zetland, NSW</p>
              <div class="unit-tag">
                <img src="../Assets/dot-grey.png" alt="dot" />
                <p>Apartment</p>
              </div>
            </div>
            <img
              class="love-icon"
              src="../Assets/love-icon.png"
              alt="Love-icon"
            />
          </div>
        </div>

        <div class="container">
          <div class="property-image">
            <div class="property-pill">
              <p>New</p>
            </div>
            <div class="property-details">
              <p>Green Square, NSW</p>
              <div class="property-details-icons">
                <div class="icon-text">
                  <p>2</p>
                  <img src="../Assets/bed.png" alt="bed" />
                </div>
                <div class="icon-text">
                  <p>2</p>
                  <img src="../Assets/shower.png" alt="toilet" />
                </div>
                <div class="icon-text">
                  <p>1</p>
                  <img src="../Assets/car.png" alt="car" />
                </div>
              </div>
            </div>
            <img src="../Assets/cream/cream2.png" alt="" />
          </div>

          <div class="love">
            <div class="text-love">
              <p>312 Zetland, NSW</p>
              <div class="unit-tag">
                <img src="../Assets/dot-grey.png" alt="dot" />
                <p>Apartment</p>
              </div>
            </div>
            <img
              class="love-icon"
              src="../Assets/love-icon.png"
              alt="Love-icon"
            />
          </div>
        </div>

        <div class="container">
          <div class="property-image">
            <div class="property-pill">
              <p>New</p>
            </div>
            <div class="property-details">
              <p>Green Square, NSW</p>
              <div class="property-details-icons">
                <div class="icon-text">
                  <p>2</p>
                  <img src="../Assets/bed.png" alt="bed" />
                </div>
                <div class="icon-text">
                  <p>2</p>
                  <img src="../Assets/shower.png" alt="toilet" />
                </div>
                <div class="icon-text">
                  <p>1</p>
                  <img src="../Assets/car.png" alt="car" />
                </div>
              </div>
            </div>
            <img src="../Assets/cream/cream1.png" alt="" />
          </div>

          <div class="love">
            <div class="text-love">
              <p>312 Zetland, NSW</p>
              <div class="unit-tag">
                <img src="../Assets/dot-grey.png" alt="dot" />
                <p>Apartment</p>
              </div>
            </div>
            <img
              class="love-icon"
              src="../Assets/love-icon.png"
              alt="Love-icon"
            />
          </div>
        </div> 
        -->
    </div>
  </div>

  <div id="newest-development">
    <div class="optimization-text">
      <p class="optimization-h1">Newest Developments</p>
      <p class="optimization-subheader">
        Streamline planning management, enhance collaboration, and deliver
        results with Central Quita
      </p>
    </div>

    <div class="news-layout">
      <img src="../Assets/news1.png" alt="news" />
      <img src="../Assets/news2.png" alt="news" />
      <img src="../Assets/news3.png" alt="news" />
      <img src="../Assets/news3.png" alt="news" />
    </div>

    <div class="controller">
      <img src="../Assets/left-arrow.png" alt="left" />
      <div class="dots-layout">
        <img src="../Assets/choosen-dot.png" alt="dot" />
        <img src="../Assets/unchoosen-dot.png" alt="dot" />
        <img src="../Assets/unchoosen-dot.png" alt="dot" />
        <img src="../Assets/unchoosen-dot.png" alt="dot" />
        <img src="../Assets/unchoosen-dot.png" alt="dot" />
      </div>
      <img src="../Assets/right-arrow.png" alt="right" />
    </div>
  </div>

  <div id="latest-news">
    <div class="optimization-text">
      <p class="optimization-h1">Latest News</p>
      <p class="optimization-subheader">
        Streamline planning management, enhance collaboration, and deliver
        results with Central Quita
      </p>
    </div>

    <div class="berita-layout">
      <div class="berita">
        <img src="../Assets/berita1.png" alt="" />
        <div class="berita-text">
          <p>
            Prince Hill period home sells for $2.9m after rate cut sales. this
            lead to rising number of homeless people in Sydney
          </p>
          <p class="duration-text">3 days ago</p>
        </div>
      </div>

      <div class="berita">
        <img src="../Assets/berita4.png" alt="" />
        <div class="berita-text">
          <p>
            Prince Hill period home sells for $2.9m after rate cut sales. this
            lead to rising number of homeless people in Sydney
          </p>
          <p class="duration-text">3 days ago</p>
        </div>
      </div>

      <div class="berita">
        <img src="../Assets/berita2.png" alt="" />
        <div class="berita-text">
          <p>
            Prince Hill period home sells for $2.9m after rate cut sales. this
            lead to rising number of homeless people in Sydney
          </p>
          <p class="duration-text">3 days ago</p>
        </div>
      </div>

      <div class="berita">
        <img src="../Assets/berita3.png" alt="" />
        <div class="berita-text">
          <p>
            Prince Hill period home sells for $2.9m after rate cut sales. this
            lead to rising number of homeless people in Sydney
          </p>
          <p class="duration-text">3 days ago</p>
        </div>
      </div>

      <div class="berita">
        <img src="../Assets/berita1.png" alt="" />
        <div class="berita-text">
          <p>
            Prince Hill period home sells for $2.9m after rate cut sales. this
            lead to rising number of homeless people in Sydney
          </p>
          <p class="duration-text">3 days ago</p>
        </div>
      </div>
    </div>

    <div class="controller">
      <img src="/Assets/left-arrow.png" alt="" />
      <div class="dots-layout">
        <img src="../Assets/choosen-dot.png" alt="" />
        <img src="../Assets/unchoosen-dot.png" alt="" />
        <img src="../Assets/unchoosen-dot.png" alt="" />
        <img src="../Assets/unchoosen-dot.png" alt="" />
        <img src="../Assets/unchoosen-dot.png" alt="" />
      </div>
      <img src="../Assets/right-arrow.png" alt="" />
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const container = document.getElementById("listingContainer");
      if (!container) return;

      //helper to escape HTML (avoid cross-site scripting from DB strings)
      function escapeHtml(str = "") {
        return String(str).replace(/[&<>"']/g, (s) => {
          return {
            "&": "&amp;",
            "<": "&lt;",
            ">": "&gt;",
            '"': "&quot;",
            "'": "&#39;",
          }[s];
        });
      }

      async function loadListings() {
        try {
          const res = await fetch("/api/listings");
          if (!res.ok) throw new Error("Failed to load listings");
          const listings = await res.json();

          const visible = listings.results.slice(0, 4);

          container.innerHTML = visible
            .map((l) => {
              const cover =
                l.image ||
                (l.images && l.images[0]) ||
                "/Assets/placeholder.png";
              const statusTag =
                l.status === "rent"
                  ? "For Rent"
                  : l.status === "buy"
                    ? "For Sale"
                    : l.status || "";

              return `
      <div class="container">
        <div class="property-image">
          <div class="property-pill"><p>${escapeHtml(statusTag)}</p></div>
          <div class="property-details">
            <p>${escapeHtml(l.suburb || "")}, ${escapeHtml(l.state || "")}</p>
            <div class="property-details-icons">
              <div class="icon-text">
                <p>${escapeHtml(l.bedrooms ?? 0)}</p>
                <img src="/Assets/bed.png" alt="bed" />
              </div>
              <div class="icon-text">
                <p>${escapeHtml(l.bathrooms ?? 0)}</p>
                <img src="/Assets/shower.png" alt="bath" />
              </div>
              <div class="icon-text">
                <p>${escapeHtml(l.carspaces ?? 0)}</p>
                <img src="/Assets/car.png" alt="car" />
              </div>
            </div>
          </div>
          <img src="${escapeHtml(cover)}" alt="property" />
        </div>
        <div class="love">
          <div class="text-love">
            <p>${escapeHtml(l.address || "")}</p>
            <div class="unit-tag">
              <img src="/Assets/dot-grey.png" alt="dot" />
              <p>${escapeHtml(l.type || "")}</p>
            </div>
          </div>
          <img class="love-icon" src="/Assets/love-icon.png" alt="Love-icon" />
        </div>
      </div>
    `;
            })
            .join("");
        } catch (err) {
          console.error(err);
          container.innerHTML = "<p>Could not load listings.</p>";
        }
      }

      loadListings();
    });

    (function () {
      const navbarUser = document.getElementById("navbarUser");
      try {
        const user = JSON.parse(localStorage.getItem("user") || "null");
        if (!user) return;

        const displayName = user.first_name?.trim() || user.email;
        navbarUser.innerHTML = `
          <span style="margin-right:10px; color:#047857; font-weight:600;">
            Welcome, ${displayName}
          </span>
          <button class="button-secondary" id="logoutBtn">Logout</button>
        `;

        document.getElementById("logoutBtn").addEventListener("click", () => {
          localStorage.removeItem("user");
          window.location.reload();
        });
      } catch (_) { }
    })();

    (function () {
      const path = location.pathname.replace(/\/+$/, "");
      const links = document.querySelectorAll(
        "#navbar .navbar-selector a[href]"
      );
      links.forEach((a) => {
        const href = a.getAttribute("href") || "";
        const isHome =
          (path === "" || path === "/") &&
          (href === "index.html" || href === "/index.html");
        const matches =
          isHome ||
          path.endsWith(href) ||
          (href.startsWith("/") && path === href);

        if (matches) a.classList.add("nav-active");
      });
    })();

    (function () {
      const shell = document.querySelector(".nav-shell");
      const btn = document.getElementById("menuToggle");
      if (btn && shell) {
        btn.addEventListener("click", () => {
          const isOpen = shell.classList.toggle("open");
          btn.setAttribute("aria-expanded", String(isOpen));
        });
      }

      const path = location.pathname.replace(/\/+$/, "");
      document.querySelectorAll("#navbar a[href]").forEach((a) => {
        const href = a.getAttribute("href") || "";
        const isHome =
          (path === "" || path === "/") &&
          (href === "index.html" || href === "/index.html");
        if (
          isHome ||
          path.endsWith(href) ||
          (href.startsWith("/") && path === href)
        ) {
          a.classList.add("nav-active");
        }
      });
    })();

    // Search functionality
    (function () {
      const searchBtn = document.getElementById("searchBtn");
      const searchInput = document.getElementById("searchInput");

      if (searchBtn && searchInput) {
        searchBtn.addEventListener("click", () => {
          const query = searchInput.value.trim();

          if (query === "") {
            alert("Please enter a suburb, postcode, or state.");
          } else {
            alert(`Searching for: ${query}`);
            console.log("User search query:", query);

            // Simulate redirect to a results page
            // In the future, this could call an API
            // window.location.href = `results.html?search=${encodeURIComponent(query)}`;
          }
        });

        // Trigger search on Enter key
        searchInput.addEventListener("keypress", (e) => {
          if (e.key === "Enter") {
            searchBtn.click();
          }
        });
      }
    })();
  </script>

  <script>
    (function () {
      // Update these selectors to match your input/button if different
      const input =
        document.querySelector("#mainQuery") ||
        document.querySelector(".search-placeholder input");
      const button =
        document.querySelector("#goBtn") ||
        document.querySelector(".button-primary-round");

      function go() {
        const q = ((input && input.value) || "").trim();
        // Go to the Buy results page we created
        location.href =
          "buyResults.html" + (q ? "?q=" + encodeURIComponent(q) : "");
      }

      if (button) button.addEventListener("click", go);
      if (input)
        input.addEventListener("keydown", (e) => {
          if (e.key === "Enter") {
            e.preventDefault();
            go();
          }
        });
    })();

    document.addEventListener("DOMContentLoaded", function () {
      const container = document.getElementById("listingContainer");

      container.addEventListener("click", function (e) {
        if (e.target.classList.contains("love-icon")) {
          const emptyHeart = "/Assets/love-icon.png";
          const filledHeart = "/Assets/ri_heart-fill.png";

          if (e.target.src.includes("love-icon.png")) {
            e.target.src = filledHeart;
          } else {
            e.target.src = emptyHeart;
          }
        }
      });
    });

    document.addEventListener("DOMContentLoaded", function () {
      const tabs = document.querySelectorAll(".search-tab:not(comingsoon)");

      tabs.forEach((tab) => {
        tab.addEventListener("click", () => {
          tabs.forEach((t) => t.classList.remove("active"));

          tab.classList.add("active");

          console.log("you selected: ", tab.dataset.type);
        });
      });
    });
  </script>
</body>

<footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-cols">
      <div class="footer-col footer-brand">
        <div class="brand">
          <img src="/Assets/Logo.png" alt="MyHome logo" class="footer-logo" />
        </div>
        <p class="footer-desc">
          Lorem ipsum dolor sit amet, consectetur adipisicing elit. Lorem
          ipsum lorem lorem ipsums sum sum sum
        </p>
      </div>

      <div class="footer-col">
        <h4 class="footer-title">Product</h4>
        <a href="#">How it works</a>
        <a href="#">Who we help</a>
        <a href="#">Features</a>
        <a href="#">Pricing</a>
      </div>

      <div class="footer-col">
        <h4 class="footer-title">Resources</h4>
        <a href="#">Get Help</a>
        <a href="#">Partnership</a>
        <a href="#">Blog</a>
        <a href="#">Legal</a>
      </div>

      <div class="footer-col">
        <h4 class="footer-title">About</h4>
        <a href="#">About</a>
        <a href="#">Sponsorship</a>
        <a href="#">Hardship</a>
        <a href="#">Contact</a>
      </div>

      <div class="footer-col footer-connect">
        <h4 class="footer-title">Connect with us</h4>
        <div class="footer-socials">
          <a href="#" aria-label="Facebook" class="icon">
            <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
              <image href="../Assets/facebook.png" xlink:href="../Assets/facebook-app-symbol.png" width="18"
                height="18" />
            </svg>
          </a>

          <a href="#" aria-label="Facebook" class="icon">
            <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
              <image href="../Assets/youtube.png" xlink:href="../Assets/facebook-app-symbol.png" width="18"
                height="18" />
            </svg>
          </a>
          <a href="#" aria-label="Facebook" class="icon">
            <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
              <image href="../Assets/twitter.png" xlink:href="../Assets/facebook-app-symbol.png" width="18"
                height="18" />
            </svg>
          </a>
        </div>
      </div>
    </div>

    <hr class="footer-divider" />

    <div class="footer-bottom">
      <div>Copyright 2025 · MyHome</div>
      <div class="footer-legal">
        <a href="#">Terms of Service</a>
        <a href="#">Privacy Policy</a>
      </div>
    </div>
  </div>
</footer>

</html>