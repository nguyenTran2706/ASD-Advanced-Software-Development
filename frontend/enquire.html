<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Enquire</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/css/style.css" />
</head>

<body>
  <header class="nav-shell">
    <div class="nav-top">
      <button id="menuToggle" class="menu-btn" aria-expanded="false" aria-controls="navLinks">
        <span class="menu-icon"></span>
        <span class="menu-text">Menu</span>
      </button>

      <a href="index.html" class="brand">
        <img src="/Assets/Logo.png" alt="logo" style="height:40px" />
      </a>

      <div class="navbar-buttons" id="navbarUser">
        <a class="button-primary" href="signUp.html" style="text-decoration:none;color:#fff">Sign Up</a>
        <a class="button-primary" href="login.html" style="text-decoration:none;color:#fff">Login</a>
      </div>
    </div>

    <div id="navLinks" class="nav-links">
      <nav id="navbar" class="navbar-selector">
        <a href="index.html">Home</a>
        <a href="buy.html">Buy</a>
        <a href="rent.html">Rent</a>
        <a href="sold.html">Sold</a>
        <a href="findAgent.html">Find Agent</a>
        <a href="news.html">News</a>
      </nav>
    </div>
  </header>

  <section class="enquiry-wrap">
    <div class="auth-card-lg">
      <h1 class="auth-title">Send an enquiry</h1>
      <p class="auth-subtitle">Ask a question about this property or request more information.</p>

      <div class="enquiry-agent" id="agentBlock"></div>

      <form id="enquiryForm" class="enquiry-form" novalidate>
        <div class="field">
          <label for="fullName">Your full name</label>
          <input id="fullName" name="fullName" required />
        </div>
        <div class="field">
          <label for="email">Email</label>
          <input id="email" name="email" type="email" required />
        </div>
        <div class="field">
          <label for="phone">Phone</label>
          <input id="phone" name="phone" inputmode="tel" />
        </div>
        <div class="field">
          <label for="message">Message</label>
          <textarea id="message" name="message" rows="4"
            placeholder="Hi, I'm interested in this property. Can I get more details?"></textarea>
        </div>

        <input type="hidden" id="agentId" name="agentId" />
        <input type="hidden" id="agentName" name="agentName" />
        <input type="hidden" id="agency" name="agency" />
        <input type="hidden" id="suburb" name="suburb" />

        <button class="btn-primary-full" type="submit">Send enquiry</button>

        <p><a class="btn-ghost-full" href="/agentResults.html">Back to results</a></p>
        <p id="formMsg" class="helper" role="status" aria-live="polite"></p>
      </form>
    </div>
  </section>

  <div class="site-footer-spacer"></div>

  <script>
    // show user if logged in
    (function () {
      const navbarUser = document.getElementById("navbarUser");
      try {
        const user = JSON.parse(localStorage.getItem("user") || "null");
        if (!user) return;

        const displayName = user.first_name?.trim() || user.email;
        navbarUser.innerHTML = `
          <span style="margin-right:10px; color:#047857; font-weight:600;">
            Welcome, ${displayName}
          </span>
          <button class="button-secondary" id="logoutBtn">Logout</button>
        `;

        document.getElementById("logoutBtn").addEventListener("click", () => {
          localStorage.removeItem("user");
          window.location.reload();
        });
      } catch (_) { }
    })();

    (async function () {
        try {
          const res = await fetch("index.html");
          const html = await res.text();
          const doc = new DOMParser().parseFromString(html, "text/html");
          const navShell = doc.querySelector(".nav-shell");
          // Find the nav bar's inline script in index.html
          const navScriptText = Array.from(doc.querySelectorAll('script:not([src])'))
                                     .find(s => s.innerText.includes('// -------- Auth area'))
                                     ?.innerText;
          
          document.querySelector(".nav-shell").replaceWith(navShell);
          if (navScriptText) {
            eval(navScriptText); // Re-run the auth/nav script
          }
        } catch(e) {
          console.error("Could not load navigation bar.", e);
        }
      })();

    const params = new URLSearchParams(location.search);
    const agentId = params.get('agentId');
    const agent = params.get('agent') || 'Agent';
    const agency = params.get('agency') || '';
    const suburb = params.get('suburb') || '';

    // show context
    const block = document.getElementById('agentBlock');
    block.innerHTML = `
      <div class="enquiry-agent-card">
        <div class="enquiry-agent-lines">
          <div class="enquiry-target">${agent}</div>
          <div class="enquiry-agency">${agency}</div>
          <div class="enquiry-suburb">${suburb}</div>
        </div>
      </div>
    `;

    // populate hidden fields
    document.getElementById('agentId').value = agentId || '';
    document.getElementById('agentName').value = agent;
    document.getElementById('agency').value = agency;
    document.getElementById('suburb').value = suburb;

    // submit (front-end only demo)
    const form = document.getElementById('enquiryForm');
    const msg = document.getElementById('formMsg');
    form.addEventListener('submit', e => {
      e.preventDefault();
      msg.classList.remove('error', 'success');
      const data = Object.fromEntries(new FormData(form).entries());

      if (!data.fullName?.trim() || !data.email?.trim()) {
        msg.classList.add('error');
        msg.textContent = 'Please enter your name and email.';
        return;
      }

      // TODO: POST to your backend endpoint if/when you build it
      console.log('Enquiry submitted:', data);

      msg.classList.add('success');
      msg.textContent = 'Thanks! Your enquiry has been sent.';
      form.reset();
    });
  </script>

  <!-- active nav pill -->
  <script>
    (function () {
      const path = location.pathname.replace(/\/+$/, '');
      document.querySelectorAll('#navbar .navbar-selector a[href]').forEach(a => {
        const href = a.getAttribute('href') || '';
        if (path.endsWith(href) || (path === '/' && href === 'index.html')) a.classList.add('nav-active');
      });
    })();

    (function () {
      const shell = document.querySelector('.nav-shell');
      const btn = document.getElementById('menuToggle');
      if (btn && shell) {
        btn.addEventListener('click', () => {
          const isOpen = shell.classList.toggle('open');
          btn.setAttribute('aria-expanded', String(isOpen));
        });
      }

      // Active tab highlighting (same logic you had)
      const path = location.pathname.replace(/\/+$/, '');
      document.querySelectorAll('#navbar a[href]').forEach(a => {
        const href = a.getAttribute('href') || '';
        const isHome = (path === '' || path === '/') && (href === 'index.html' || href === '/index.html');
        if (isHome || path.endsWith(href) || (href.startsWith('/') && path === href)) {
          a.classList.add('nav-active');
        }
      });
    })();
  </script>
</body>

<footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-cols">
      <div class="footer-col footer-brand">
        <div class="brand">
          <img src="/Assets/Logo.png" alt="MyHome logo" class="footer-logo" />
          <span class="brand-text">MyHome</span>
        </div>
        <p class="footer-desc">
          Lorem ipsum dolor sit amet, consectetur adipisicing elit. Lorem ipsum
          lorem lorem ipsums sum sum sum
        </p>
      </div>

      <div class="footer-col">
        <h4 class="footer-title">Product</h4>
        <a href="#">How it works</a>
        <a href="#">Who we help</a>
        <a href="#">Features</a>
        <a href="#">Pricing</a>
      </div>

      <div class="footer-col">
        <h4 class="footer-title">Resources</h4>
        <a href="#">Get Help</a>
        <a href="#">Partnership</a>
        <a href="#">Blog</a>
        <a href="#">Legal</a>
      </div>

      <div class="footer-col">
        <h4 class="footer-title">About</h4>
        <a href="#">About</a>
        <a href="#">Sponsorship</a>
        <a href="#">Hardship</a>
        <a href="#">Contact</a>
      </div>

      <div class="footer-col footer-connect">
        <h4 class="footer-title">Connect with us</h4>
        <div class="footer-socials">
          <!-- Simple inline SVGs so you don't depend on external assets -->
          <a href="#" aria-label="Facebook" class="icon">
            <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
              <image href="../Assets/facebook.png" xlink:href="../Assets/facebook-app-symbol.png" width="18"
                height="18" />
            </svg>
          </a>

          <a href="#" aria-label="Facebook" class="icon">
            <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
              <image href="../Assets/youtube.png" xlink:href="../Assets/facebook-app-symbol.png" width="18"
                height="18" />
            </svg>
          </a>
          <a href="#" aria-label="Facebook" class="icon">
            <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
              <image href="../Assets/twitter.png" xlink:href="../Assets/facebook-app-symbol.png" width="18"
                height="18" />
            </svg>
          </a>
        </div>
      </div>
    </div>

    <hr class="footer-divider" />

    <div class="footer-bottom">
      <div>Copyright 2025 Â· MyHome</div>
      <div class="footer-legal">
        <a href="#">Terms of Service</a>
        <a href="#">Privacy Policy</a>
      </div>
    </div>
  </div>
</footer>

</html>